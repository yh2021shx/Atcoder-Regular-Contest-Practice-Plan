# B

```
Quality = 高
Difficulty = 1600
Personal_Difficulty = NOIP_T2
Time = 2025.9.24
Tag = 思维 计数
```

## 题解

首先，可以猜测这道题一定是乘法原理状物的题目。乘法原理要有个顺序，所以考虑行从下往上扫。

那么，对于一行来说，中间的点只会影响之后的一列，两边的点会影响两列。

**一个关键观察是，对于整个 $n \times n$ 的网格，只有上面 $\frac{1}{4}$ 的部分是有用的。（因为对于两边的点，如果它影响了两列，最终一定不够放下 $n$ 个棋子）**

因此，每个点只有中间的有用，而中间的点恰好会让之后的一列不能安放棋子，因此简单的组合数就能通过此题。

## 反思

* **一定要对当前的结构观察充分。**（在这道题里，我们要注意到总共只能放 $n$ 个棋子，不可能存在一个棋子占两列）
* **遇到结构复杂的题，可以尝试将简单的情况先考虑，然后一步步化简问题。**

# C

```
Quality = 中
Difficulty = 2100
Time = 2025.9.24
Tag = DP DS
```

## 题解

首先，找一个刻画 $A, B$ 买东西的更美的形式。

实际上，结构很简单：对于 $A$ 买的东西，第一个物品 $x$ 在 $A$ 中前面的物品都要被 $B$ 先买到。意思就是，这些物品在 $B$ 中也在 $x$ 之前。对于后面的物品，区别无非就是前面已经在 $A$ 中的物品不用 $B$ 买，因此不受限制。

这时，就有 DP。设 $f_{i, j}$ 表示前 $i$ 个数，没选的数在 $B$ 中出现的最大下标是 $j$，那这个 DP 就可以轻松用线段树优化到 $\mathcal{O}(n\log n)$。

## 反思

* **在真实赛场的高压情况下，要保持冷静想清楚结构。**
* 看起来高维的 DP 其实也可以一试。

# D

```
Quality = 高
Difficulty = 2700
Time = 2025.9.25
Tag = 计数 思维
```

## 题解

第一步是将题目的最终序列的充要条件找到。由于比较容易，这里直接放结论：

* 序列是递增的，且相邻两个数的差不超过 $1$
* 除了首尾连通块，其他的连通块都是奇数长

现在考虑对这个东西计数。假设我们现在要计算 $k$ 段的答案，并且开始的值是 $L$。

现在设 $f_{i}$ 表示最终在 $i$ 位置上的数的个数，那么最终的价值就是 $\sum_{j = 1}^n f_{j} \times a_j$，并且 $f$ 要满足 $f_L + f_{L+1} + \cdots + f_{L + k - 1} = n$，其中中间项都是奇数。

**枚举首尾项的奇偶性 $1 \leq x, y \leq 2$，那么我们容易转化为 $S = n - x - y - (k - 2)$，将 $f_i$ 看作 $g_i + t(1 \leq t \leq 2)$。**

因此，接下来的条件就是 $\sum_{i = L}^{L + k - 1} g_i = \dfrac{S}{2}$。

注意到这里 $g_i$ 都是地位相等的，因此 $g_i$ 的期望值应该都是 $\dfrac{S}{2k}$。综上，答案应该是 $\sum \text{way} \times (\dfrac{S}{k} + t) \times a_i$。

注意，到这里这个程序还是 $\mathcal{O}(n^2\log)$。但其实我们发现，最终答案的式子其实与 $L$ 没多大关系，前缀和可以较为轻松的计算。$t$ 的处理较为繁琐。

## 总结

* **遇到结构复杂的题，可以尝试将简单的情况先考虑，然后一步步化简问题。**（在这道题里的体现就是将奇偶性的限制去除）
* **计数时，遇到地位相等的一些对象，期望能发挥奇效。**（本质上其实与期望没关系）
