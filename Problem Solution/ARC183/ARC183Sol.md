# B

```
Quality = 高
Difficulty = 2118
Personal_Difficulty = NOIP_T2.5
Time = 2025.9.23
Tag = 思维 分析
```

## 题解

首先，如果 $B$ 中出现了 $A$ 中没有的数，答案肯定是 `NO`。如果 $A = B$，答案肯定是 `YES`。

**整题最重要观察：如果有一个自由点且 $k > 1$，那么我们可以随意交换任意相邻的两个数。**

> 证明：考虑每次把自由点往这两个数靠近，如果距离 $\leq k$，那么我们就可以以自由点为中转站来进行交换。 

推论显而易见：如果有一个自由点且 $k > 1$，那么我们可以任意重排整个序列（除了自由点），并且每个数都可以等于在 $A$ 中有的值。

先考虑 $k = 1$，那么只能相邻赋值，显然最后的答案形如一段一段的相等数，可以给 $B$ 压块后判断是否是子序列。

然后考虑 $k > 1$，如果有自由点，由于推论且元素集合是一样的，肯定有解。因此，问题转化为是否存在自由点。

我们考虑刻画自由点，这是一个下标 $p$，使得别的数都和 $B$ 相等的时候，存在一个数能给他赋值，使得 $a_p = b_p$。那么，这其实就是问是否存在 $b_i = b_p, |i - p| \leq k$，而这个很好判断。

## 实现

* 首先，我们需要记一个桶来判断特殊情况。
* 为了判断是否存在自由点，我们需要存个 `vector`。
* 小心 Corner Case。

## 反思

这是一道典型的 Atcoder 风格题目，十分考验对题目的直觉和分析。

* $|i - j| \leq k$ 其实会提示你跟区间有关。（在本题里是相邻）
* **直接做十分困难，我们要尝试简化操作。**
* 先把几种简单的情况判掉，否则容易忘考虑。

# C

```
Quality = 低
Difficulty = 2018
Personal_Difficulty = NOIP_T2
Time = 2025.9.23
Tag = 区间DP
```

## 题解

考虑序列最大值，假设 $a_p = n$，那么如果区间 $[l, r]$ 包含 $p$，那么需要判断一下是否满足条件。

那么，整个序列相当于被切成了两段，而这两段显然是互补影响的。

因此，容易想到 $f_{l, r}$ 表示这个区间填数的方案数（我们这里定义填的是 $1$ 到 $r - l + 1$），那么转移如下：

$$
f_{l,  r} = \sum_{l \leq p \leq r} [check(p)]f_{l, p - 1}f_{p + 1, r}\binom{r - l}{p - l}
$$

如何判断 $p$ 是否能作为最大值？相当于我们要看是否存在一个区间 $l <= l_i <= r_i <= r$，使得 $x_i = p$。我们预处理一个 $chk_{l, x}$ 表示当 $l \leq l_i, x_i = x$ 的时候，$r_i$ 的最大值，那么 $chk$ 的转移就是：

$$
chk_{l, x} = \max\{chk_{l + 1, x}, [l_j = l, x_j = x]r_j\}
$$

代码比较好写。

## 总结

* 这种题一般都是考虑最大值。
* 遇到这种题，需要提升写代码的速度（也就是快速把细节搞清楚）
